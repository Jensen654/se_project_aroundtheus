!function(){"use strict";class e{constructor(e,t,s,i,n){this._name=e.name,this._link=e.link,this._id=e._id,this._isLiked=e.isLiked,this._cardSelector=t,this._handleImageClick=s,this._handleDeleteClick=i,this._handleLikeButton=n}_setEventListeners(){this._cardImageElement.addEventListener("click",(()=>this._handleImageClick({name:this._name,link:this._link}))),this._likeButton.addEventListener("click",(()=>{this._handleLikeButton(this)})),this._deleteButton.addEventListener("click",(()=>{this._handleDeleteClick(this)}))}remove(){this._cardElement.remove()}setIsLiked(e){this._isLiked=e,this._renderLikes()}isLiked(){return this._isLiked}_renderLikes(){this._isLiked?this._likeButton.classList.add("card__like-button_active"):this._isLiked||this._likeButton.classList.remove("card__like-button_active")}returnCardElement(){return this._cardElement=document.querySelector(this._cardSelector).content.querySelector(".card").cloneNode(!0),this._likeButton=this._cardElement.querySelector(".card__like-button"),this._deleteButton=this._cardElement.querySelector(".card__trash-button"),this._cardDescription=this._cardElement.querySelector(".card__text"),this._cardImageElement=this._cardElement.querySelector(".card__img"),this._cardImageElement.src=this._link,this._cardImageElement.alt=this._name,this._cardDescription.textContent=this._name,this._renderLikes(),this._setEventListeners(),this._cardElement}}class t{constructor(e,t){this._options=e,this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._formElement=t}_showInputError(e){const t=this._formElement.querySelector(`#${e.id}-error`);e.classList.add(this._inputErrorClass),t.textContent=e.validationMessage,t.classList.add(this._errorClass)}_hideInputError(e){const t=this._formElement.querySelector(`#${e.id}-error`);e.classList.remove(this._inputErrorClass),t.textContent="",t.classList.remove(this._errorClass)}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e)}_checkFormValidity(){return Array.from(this._inputEls).every((e=>e.validity.valid))}toggleButtonState(){this._checkFormValidity()?(this._submitButton.classList.remove(this._inactiveButtonClass),this._submitButton.disabled=!1):(this._submitButton.classList.add(this._inactiveButtonClass),this._submitButton.disabled=!0)}_setEventListeners(e){e.addEventListener("input",(()=>{this._checkInputValidity(e),this.toggleButtonState()}))}enableValidation(){this._inputEls=this._formElement.querySelectorAll(this._inputSelector),this._submitButton=this._formElement.querySelector(this._submitButtonSelector),this._formElement.addEventListener("submit",(e=>{e.preventDefault()})),this._inputEls.forEach((e=>{this._setEventListeners(e,this._submitButton)}))}}class s{constructor(e){this._popupElement=e,this._closeButton=this._popupElement.querySelector(".modal__close"),this._modalContainer=this._popupElement.querySelector(".js-modalContainer"),this._boundHandleEscapeClose=this._handleEscapeClose.bind(this)}open(){this._popupElement.classList.add("modal_opened"),document.addEventListener("keydown",this._boundHandleEscapeClose)}close(){this._popupElement.classList.remove("modal_opened"),document.removeEventListener("keydown",this._boundHandleEscapeClose)}_handleEscapeClose(e){"Escape"===e.key&&this.close()}setEventListeners(){this._closeButton.addEventListener("click",(()=>{this.close()})),this._popupElement.addEventListener("click",(()=>{this.close()})),this._modalContainer.addEventListener("click",(e=>{e.stopPropagation()}))}}class i extends s{constructor(e,t,s){super(e),this._submitButton=this._popupElement.querySelector(".modal__button"),this._handleFormSubmit=t,this._buttonText=this._submitButton.textContent,this._loadingButtonText=s,this._popupForm=this._popupElement.querySelector(".modal__container-form"),this._inputList=this._popupElement.querySelectorAll(".modal__container-input")}showLoading(){this._submitButton.textContent=this._loadingButtonText}hideLoading(){this._submitButton.textContent=this._buttonText}_getInputValues(){const e={};return this._inputList.forEach((t=>{e[t.name]=t.value})),e}setEventListeners(){super.setEventListeners(),this._popupForm.addEventListener("submit",(e=>{e.preventDefault();const t=this._getInputValues();this._handleFormSubmit(t)}))}}const n={formSelector:".modal__container-form",inputSelector:".modal__container-input",submitButtonSelector:".modal__button",inactiveButtonClass:"modal__button_disabled",inputErrorClass:"modal__input_error",errorClass:"modal__error_visible"},o=document.querySelector("#card-modal"),r=document.querySelector("#edit-modal"),a=document.querySelector("#profile-image-modal"),l=r.querySelector(".modal__container-form"),c=o.querySelector(".modal__container-form"),d=a.querySelector(".modal__container-form"),h=document.querySelector("#image-modal"),u=document.querySelector("#trash-modal"),_=document.querySelector(".profile__image"),m=document.querySelector(".profile__edit-button"),p=document.querySelector(".profile__image_edit-button"),E=document.querySelector(".profile__add-button"),f=document.querySelector(".profile__title"),L=document.querySelector(".profile__description"),b=r.querySelector("#modal-name"),g=r.querySelector("#modal-description"),v=a.querySelector(".modal__container-input"),C=document.querySelector(".cards__list"),S="Saving...",k=new t(n,l),y=new t(n,c),B=new t(n,d);k.enableValidation(),y.enableValidation(),B.enableValidation();const I=new class extends s{constructor(e){super(e)}open(e){const t=this._popupElement.querySelector(".modal__image"),s=this._popupElement.querySelector(".modal__image-description");t.src=e.link,t.alt=e.name,s.textContent=e.name,super.open()}}(h);I.setEventListeners();const q=new i(r,(function(e){q.showLoading(),D.updateProfileInfo({name:e.title,about:e.description}).then((()=>{U.setUserInfo({nameInput:e.title,descriptionInput:e.description}),q.close()})).catch((e=>console.log(e))).finally((()=>{q.hideLoading()}))}),S),x=new i(o,(function(e){const t=e.title,s=e.description;x.showLoading(),D.addCard({name:t,link:s}).then((()=>{R({name:t,link:s}),x.close(),c.reset(),y.toggleButtonState()})).catch((e=>console.log(e))).finally((()=>{x.hideLoading()}))}),S),w=new i(a,(function(e){w.showLoading(),D.updateProfilePic(e).then((()=>{U.setAvatar(v.value),w.close(),d.reset(),y.toggleButtonState()})).catch((e=>console.log(e))).finally((()=>{w.hideLoading()}))}),S);q.setEventListeners(),x.setEventListeners(),w.setEventListeners();const P=new class extends s{constructor(e,t){super(e),this._submitButton=this._popupElement.querySelector(".modal__button"),this._buttonText=this._submitButton.textContent,this._loadingButtonText=t}showLoading(){this._submitButton.textContent=this._loadingButtonText}hideLoading(){this._submitButton.textContent=this._buttonText}setEventListeners(){super.setEventListeners(),this._modalContainer.addEventListener("submit",(e=>{e.preventDefault(),this._handleDeleteFormSubmit()}))}setSubmitAction(e){this._handleDeleteFormSubmit=e}}(u,S);P.setEventListeners();const U=new class{constructor(e){let{nameContainer:t,descriptionContainer:s,profilePic:i}=e;this._nameContainer=t,this._descriptionContainer=s,this._profilePic=i}getUserInfo(){const e={};return e.profileName=this._nameContainer.textContent,e.profileDescription=this._descriptionContainer.textContent,e}setAvatar(e){this._profilePic.src=e}setUserInfo(e){this._nameContainer.textContent=e.nameInput,this._descriptionContainer.textContent=e.descriptionInput}}({nameContainer:f,descriptionContainer:L,profilePic:_}),D=new class{constructor(e){this._baseUrl=e.baseUrl,this._headers=e.headers}_processResponse=e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`);getInitialCards(){return fetch(`${this._baseUrl}/cards`,{headers:this._headers}).then(this._processResponse)}addCard(e){return fetch(`${this._baseUrl}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify(e)}).then(this._processResponse)}deleteCard(e){return fetch(`${this._baseUrl}/cards/${e}`,{method:"DELETE",headers:this._headers}).then(this._processResponse)}toggleCardLike(e){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:"PUT",headers:this._headers}).then(this._processResponse)}toggleCardDislike(e){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:"DELETE",headers:this._headers}).then(this._processResponse)}getProfileInfo(){return fetch(`${this._baseUrl}/users/me`,{headers:this._headers}).then(this._processResponse)}updateProfileInfo(e){return fetch(`${this._baseUrl}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify(e)}).then(this._processResponse)}updateProfilePic(e){return fetch(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify(e)}).then(this._processResponse)}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"1755563a-df02-4ecd-aa91-5c5958bedadf","Content-Type":"application/json"}}),T=new class{constructor(e,t){let{renderer:s}=e;this._render=s,this._container=t}renderItems(e){e.forEach((e=>this._render(e)))}addItem(e){this._container.prepend(e)}}({renderer:R},C);function $(e){I.open(e)}function A(e){P.open(),P.setSubmitAction((()=>(P.showLoading(),D.deleteCard(e._id).then((()=>{e.remove(),P.close()})).catch((e=>console.log(e))).finally((()=>{P.hideLoading()})))))}function V(e){e.isLiked?D.toggleCardDislike(e._id).then((t=>e.setIsLiked(t._isLiked))).catch((e=>console.log(e))):e.isLiked||D.toggleCardLike(e._id).then((t=>e.setIsLiked(t._isLiked))).catch((e=>console.log(e)))}function R(t){const s=new e(t,".card-template",$,A,V).returnCardElement();T.addItem(s)}D.getInitialCards().then((e=>{T.renderItems(e)})).catch((e=>console.log(e))),D.getProfileInfo().then((e=>(U.setAvatar(e.avatar),U.setUserInfo({nameInput:e.name,descriptionInput:e.about})))).catch((e=>console.log(e))),m.addEventListener("click",(function(e){!function(){const e=U.getUserInfo();b.value=e.profileName,g.value=e.profileDescription}(),q.open()})),E.addEventListener("click",(e=>{x.open()})),p.addEventListener("click",(()=>{w.open()}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QmpCLE1BQVFzRyxFQUFPdkYsWUFDaENHLEVBQXdCbEIsTUFBUXNHLEVBQU90RixrQkFDekMsQ0FvSEV1RixHQUNBNUUsRUFBaUI5QyxNQUNuQixJQUVBaUMsRUFBV2pHLGlCQUFpQixTQUFVcUUsSUFDcEN5RCxFQUFjOUQsTUFBTSxJQUd0QmdDLEVBQXVCaEcsaUJBQWlCLFNBQVMsS0FDL0NrSSxFQUFzQmxFLE1BQU0sRyIsInNvdXJjZXMiOlsid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvY29tcG9uZW50cy9DYXJkLmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvY29tcG9uZW50cy9Qb3B1cC5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL3V0aWxzL2NvbnN0YW50cy5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL3BhZ2VzL2luZGV4LmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoRGVsZXRlLmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvY29tcG9uZW50cy9Vc2VySW5mby5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL2NvbXBvbmVudHMvQXBpLmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvY29tcG9uZW50cy9TZWN0aW9uLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBkZWZhdWx0IGNsYXNzIENhcmQge1xyXG4gIGNvbnN0cnVjdG9yKFxyXG4gICAgZGF0YSxcclxuICAgIGNhcmRTZWxlY3RvcixcclxuICAgIGhhbmRsZUltYWdlQ2xpY2ssXHJcbiAgICBoYW5kbGVEZWxldGVDbGljayxcclxuICAgIGhhbmRsZUxpa2VCdXR0b25cclxuICApIHtcclxuICAgIHRoaXMuX25hbWUgPSBkYXRhLm5hbWU7XHJcbiAgICB0aGlzLl9saW5rID0gZGF0YS5saW5rO1xyXG4gICAgdGhpcy5faWQgPSBkYXRhLl9pZDtcclxuICAgIHRoaXMuX2lzTGlrZWQgPSBkYXRhLmlzTGlrZWQ7XHJcbiAgICB0aGlzLl9jYXJkU2VsZWN0b3IgPSBjYXJkU2VsZWN0b3I7XHJcbiAgICB0aGlzLl9oYW5kbGVJbWFnZUNsaWNrID0gaGFuZGxlSW1hZ2VDbGljaztcclxuICAgIHRoaXMuX2hhbmRsZURlbGV0ZUNsaWNrID0gaGFuZGxlRGVsZXRlQ2xpY2s7XHJcbiAgICB0aGlzLl9oYW5kbGVMaWtlQnV0dG9uID0gaGFuZGxlTGlrZUJ1dHRvbjtcclxuICAgIC8vIHRoaXMuX2hhbmRsZUxpa2VDbGljayA9IGhhbmRsZUxpa2VDbGljaztcclxuICAgIC8vIHRoaXMuX2hhbmRsZUxpa2VEZWxldGUgPSBoYW5kbGVMaWtlRGVsZXRlO1xyXG4gIH1cclxuXHJcbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgdGhpcy5fY2FyZEltYWdlRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT5cclxuICAgICAgdGhpcy5faGFuZGxlSW1hZ2VDbGljayh7IG5hbWU6IHRoaXMuX25hbWUsIGxpbms6IHRoaXMuX2xpbmsgfSlcclxuICAgICk7XHJcbiAgICB0aGlzLl9saWtlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgIHRoaXMuX2hhbmRsZUxpa2VCdXR0b24odGhpcyk7XHJcbiAgICB9KTtcclxuICAgIHRoaXMuX2RlbGV0ZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgICB0aGlzLl9oYW5kbGVEZWxldGVDbGljayh0aGlzKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgcmVtb3ZlKCkge1xyXG4gICAgdGhpcy5fY2FyZEVsZW1lbnQucmVtb3ZlKCk7XHJcbiAgICAvLyB0aGlzLl9jYXJkRWxlbWVudCA9IG51bGw7XHJcbiAgfVxyXG5cclxuICAvLyBfaGFuZGxlTGlrZUJ1dHRvbigpIHtcclxuICAvLyAgIGlmICghdGhpcy5faXNMaWtlZCkge1xyXG4gIC8vICAgICB0aGlzLl9oYW5kbGVMaWtlQ2xpY2sodGhpcy5faWQpXHJcbiAgLy8gICAgICAgLnRoZW4oKCkgPT4ge1xyXG4gIC8vICAgICAgICAgdGhpcy5fbGlrZUJ1dHRvbi5jbGFzc0xpc3QuYWRkKFwiY2FyZF9fbGlrZS1idXR0b25fYWN0aXZlXCIpO1xyXG4gIC8vICAgICAgICAgdGhpcy5faXNMaWtlZCA9IHRydWU7XHJcbiAgLy8gICAgICAgfSlcclxuICAvLyAgICAgICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5sb2coZXJyKSk7XHJcbiAgLy8gICB9IGVsc2UgaWYgKHRoaXMuX2lzTGlrZWQpIHtcclxuICAvLyAgICAgdGhpcy5faGFuZGxlTGlrZURlbGV0ZSh0aGlzLl9pZClcclxuICAvLyAgICAgICAudGhlbigoKSA9PiB7XHJcbiAgLy8gICAgICAgICB0aGlzLl9saWtlQnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUoXCJjYXJkX19saWtlLWJ1dHRvbl9hY3RpdmVcIik7XHJcbiAgLy8gICAgICAgICB0aGlzLl9pc0xpa2VkID0gZmFsc2U7XHJcbiAgLy8gICAgICAgfSlcclxuICAvLyAgICAgICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5sb2coZXJyKSk7XHJcbiAgLy8gICB9XHJcbiAgLy8gfVxyXG5cclxuICBzZXRJc0xpa2VkKGlzTGlrZWQpIHtcclxuICAgIHRoaXMuX2lzTGlrZWQgPSBpc0xpa2VkO1xyXG4gICAgdGhpcy5fcmVuZGVyTGlrZXMoKTtcclxuICB9XHJcblxyXG4gIGlzTGlrZWQoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5faXNMaWtlZDtcclxuICB9XHJcblxyXG4gIF9yZW5kZXJMaWtlcygpIHtcclxuICAgIGlmICh0aGlzLl9pc0xpa2VkKSB7XHJcbiAgICAgIHRoaXMuX2xpa2VCdXR0b24uY2xhc3NMaXN0LmFkZChcImNhcmRfX2xpa2UtYnV0dG9uX2FjdGl2ZVwiKTtcclxuICAgIH0gZWxzZSBpZiAoIXRoaXMuX2lzTGlrZWQpIHtcclxuICAgICAgdGhpcy5fbGlrZUJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKFwiY2FyZF9fbGlrZS1idXR0b25fYWN0aXZlXCIpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcmV0dXJuQ2FyZEVsZW1lbnQoKSB7XHJcbiAgICAvL2dldCBjYXJkIHZpZXdcclxuICAgIHRoaXMuX2NhcmRFbGVtZW50ID0gZG9jdW1lbnRcclxuICAgICAgLnF1ZXJ5U2VsZWN0b3IodGhpcy5fY2FyZFNlbGVjdG9yKVxyXG4gICAgICAuY29udGVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRcIilcclxuICAgICAgLmNsb25lTm9kZSh0cnVlKTtcclxuICAgIHRoaXMuX2xpa2VCdXR0b24gPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2xpa2UtYnV0dG9uXCIpO1xyXG4gICAgdGhpcy5fZGVsZXRlQnV0dG9uID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX190cmFzaC1idXR0b25cIik7XHJcbiAgICB0aGlzLl9jYXJkRGVzY3JpcHRpb24gPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX3RleHRcIik7XHJcbiAgICB0aGlzLl9jYXJkSW1hZ2VFbGVtZW50ID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19pbWdcIik7XHJcblxyXG4gICAgLy9jYXJkIGltYWdlIGFuZCBzb3VyY2VcclxuICAgIHRoaXMuX2NhcmRJbWFnZUVsZW1lbnQuc3JjID0gdGhpcy5fbGluaztcclxuICAgIHRoaXMuX2NhcmRJbWFnZUVsZW1lbnQuYWx0ID0gdGhpcy5fbmFtZTtcclxuICAgIHRoaXMuX2NhcmREZXNjcmlwdGlvbi50ZXh0Q29udGVudCA9IHRoaXMuX25hbWU7XHJcblxyXG4gICAgdGhpcy5fcmVuZGVyTGlrZXMoKTtcclxuXHJcbiAgICAvL3NldCBldmVudCBsaXN0ZW5lcnNcclxuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgICAvL3JldHVybiBjYXJkXHJcbiAgICByZXR1cm4gdGhpcy5fY2FyZEVsZW1lbnQ7XHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEZvcm1WYWxpZGF0b3Ige1xyXG4gIGNvbnN0cnVjdG9yKG9wdGlvbnMsIGZvcm1FbGVtZW50KSB7XHJcbiAgICB0aGlzLl9vcHRpb25zID0gb3B0aW9ucztcclxuICAgIHRoaXMuX2lucHV0U2VsZWN0b3IgPSBvcHRpb25zLmlucHV0U2VsZWN0b3I7XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3RvciA9IG9wdGlvbnMuc3VibWl0QnV0dG9uU2VsZWN0b3I7XHJcbiAgICB0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzID0gb3B0aW9ucy5pbmFjdGl2ZUJ1dHRvbkNsYXNzO1xyXG4gICAgdGhpcy5faW5wdXRFcnJvckNsYXNzID0gb3B0aW9ucy5pbnB1dEVycm9yQ2xhc3M7XHJcbiAgICB0aGlzLl9lcnJvckNsYXNzID0gb3B0aW9ucy5lcnJvckNsYXNzO1xyXG5cclxuICAgIHRoaXMuX2Zvcm1FbGVtZW50ID0gZm9ybUVsZW1lbnQ7XHJcbiAgfVxyXG5cclxuICBfc2hvd0lucHV0RXJyb3IoaW5wdXRFbCkge1xyXG4gICAgY29uc3QgZXJyb3JNZXNzYWdlRWwgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICBgIyR7aW5wdXRFbC5pZH0tZXJyb3JgXHJcbiAgICApO1xyXG4gICAgaW5wdXRFbC5jbGFzc0xpc3QuYWRkKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XHJcbiAgICBlcnJvck1lc3NhZ2VFbC50ZXh0Q29udGVudCA9IGlucHV0RWwudmFsaWRhdGlvbk1lc3NhZ2U7XHJcbiAgICBlcnJvck1lc3NhZ2VFbC5jbGFzc0xpc3QuYWRkKHRoaXMuX2Vycm9yQ2xhc3MpO1xyXG4gIH1cclxuXHJcbiAgX2hpZGVJbnB1dEVycm9yKGlucHV0RWwpIHtcclxuICAgIGNvbnN0IGVycm9yTWVzc2FnZUVsID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAgICAgYCMke2lucHV0RWwuaWR9LWVycm9yYFxyXG4gICAgKTtcclxuICAgIGlucHV0RWwuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xyXG4gICAgZXJyb3JNZXNzYWdlRWwudGV4dENvbnRlbnQgPSBcIlwiO1xyXG4gICAgZXJyb3JNZXNzYWdlRWwuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9lcnJvckNsYXNzKTtcclxuICB9XHJcblxyXG4gIF9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbCkge1xyXG4gICAgaWYgKCFpbnB1dEVsLnZhbGlkaXR5LnZhbGlkKSB7XHJcbiAgICAgIHRoaXMuX3Nob3dJbnB1dEVycm9yKGlucHV0RWwpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBfY2hlY2tGb3JtVmFsaWRpdHkoKSB7XHJcbiAgICByZXR1cm4gQXJyYXkuZnJvbSh0aGlzLl9pbnB1dEVscykuZXZlcnkoKGlucHV0KSA9PiBpbnB1dC52YWxpZGl0eS52YWxpZCk7XHJcbiAgfVxyXG5cclxuICB0b2dnbGVCdXR0b25TdGF0ZSgpIHtcclxuICAgIGNvbnN0IGZvdW5kSW52YWxpZCA9ICF0aGlzLl9jaGVja0Zvcm1WYWxpZGl0eSgpO1xyXG5cclxuICAgIGlmIChmb3VuZEludmFsaWQpIHtcclxuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLmNsYXNzTGlzdC5hZGQodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IHRydWU7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24uY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLmRpc2FibGVkID0gZmFsc2U7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoaW5wdXRFbCkge1xyXG4gICAgaW5wdXRFbC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgKCkgPT4ge1xyXG4gICAgICB0aGlzLl9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbCk7XHJcbiAgICAgIHRoaXMudG9nZ2xlQnV0dG9uU3RhdGUoKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZW5hYmxlVmFsaWRhdGlvbigpIHtcclxuICAgIHRoaXMuX2lucHV0RWxzID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCh0aGlzLl9pbnB1dFNlbGVjdG9yKTtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbiA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yXHJcbiAgICApO1xyXG4gICAgdGhpcy5fZm9ybUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZ0KSA9PiB7XHJcbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgdGhpcy5faW5wdXRFbHMuZm9yRWFjaCgoaW5wdXRFbCkgPT4ge1xyXG4gICAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycyhpbnB1dEVsLCB0aGlzLl9zdWJtaXRCdXR0b24pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XHJcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQgPSBwb3B1cFNlbGVjdG9yO1xyXG5cclxuICAgIHRoaXMuX2Nsb3NlQnV0dG9uID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Nsb3NlXCIpO1xyXG5cclxuICAgIHRoaXMuX21vZGFsQ29udGFpbmVyID1cclxuICAgICAgdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuanMtbW9kYWxDb250YWluZXJcIik7XHJcblxyXG4gICAgdGhpcy5fYm91bmRIYW5kbGVFc2NhcGVDbG9zZSA9IHRoaXMuX2hhbmRsZUVzY2FwZUNsb3NlLmJpbmQodGhpcyk7XHJcbiAgfVxyXG5cclxuICBvcGVuKCkge1xyXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJtb2RhbF9vcGVuZWRcIik7XHJcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9ib3VuZEhhbmRsZUVzY2FwZUNsb3NlKTtcclxuICB9XHJcblxyXG4gIGNsb3NlKCkge1xyXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoXCJtb2RhbF9vcGVuZWRcIik7XHJcbiAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9ib3VuZEhhbmRsZUVzY2FwZUNsb3NlKTtcclxuICB9XHJcblxyXG4gIF9oYW5kbGVFc2NhcGVDbG9zZShldnQpIHtcclxuICAgIGlmIChldnQua2V5ID09PSBcIkVzY2FwZVwiKSB7XHJcbiAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgdGhpcy5fY2xvc2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgIH0pO1xyXG5cclxuICAgIHRoaXMuX21vZGFsQ29udGFpbmVyLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZXZlbnQpID0+IHtcclxuICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICB9KTtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhGb3JtIGV4dGVuZHMgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IsIGhhbmRsZUZvcm1TdWJtaXQsIGxvYWRpbmdCdXR0b25UZXh0KSB7XHJcbiAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbiA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19idXR0b25cIik7XHJcbiAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0ID0gaGFuZGxlRm9ybVN1Ym1pdDtcclxuICAgIHRoaXMuX2J1dHRvblRleHQgPSB0aGlzLl9zdWJtaXRCdXR0b24udGV4dENvbnRlbnQ7XHJcblxyXG4gICAgdGhpcy5fbG9hZGluZ0J1dHRvblRleHQgPSBsb2FkaW5nQnV0dG9uVGV4dDtcclxuXHJcbiAgICB0aGlzLl9wb3B1cEZvcm0gPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAgICAgXCIubW9kYWxfX2NvbnRhaW5lci1mb3JtXCJcclxuICAgICk7XHJcblxyXG4gICAgdGhpcy5faW5wdXRMaXN0ID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXHJcbiAgICAgIFwiLm1vZGFsX19jb250YWluZXItaW5wdXRcIlxyXG4gICAgKTtcclxuICB9XHJcblxyXG4gIHNob3dMb2FkaW5nKCkge1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50ID0gdGhpcy5fbG9hZGluZ0J1dHRvblRleHQ7XHJcbiAgfVxyXG5cclxuICBoaWRlTG9hZGluZygpIHtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9IHRoaXMuX2J1dHRvblRleHQ7XHJcbiAgfVxyXG5cclxuICBfZ2V0SW5wdXRWYWx1ZXMoKSB7XHJcbiAgICBjb25zdCBkYXRhID0ge307XHJcblxyXG4gICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0KSA9PiB7XHJcbiAgICAgIGRhdGFbaW5wdXQubmFtZV0gPSBpbnB1dC52YWx1ZTtcclxuICAgIH0pO1xyXG5cclxuICAgIHJldHVybiBkYXRhO1xyXG4gIH1cclxuXHJcbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuICAgIHRoaXMuX3BvcHVwRm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldnQpID0+IHtcclxuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgIGNvbnN0IGZvcm1EYXRhID0gdGhpcy5fZ2V0SW5wdXRWYWx1ZXMoKTtcclxuICAgICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdChmb3JtRGF0YSk7XHJcbiAgICAgIC8vIHRoaXMuX3BvcHVwRm9ybS5yZXNldCgpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG59XHJcbiIsImNvbnN0IGluaXRpYWxDYXJkcyA9IFtcclxuICB7XHJcbiAgICBuYW1lOiBcIllvc2VtaXRlIFZhbGxleVwiLFxyXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L3lvc2VtaXRlLmpwZ1wiLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJMYWtlIExvdWlzZVwiLFxyXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2xha2UtbG91aXNlLmpwZ1wiLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJCYWxkIE1vdW50YWluc1wiLFxyXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2JhbGQtbW91bnRhaW5zLmpwZ1wiLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJMYXRlbWFyXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvbGF0ZW1hci5qcGdcIixcclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWU6IFwiVmFub2lzZSBOYXRpb25hbCBQYXJrXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvdmFub2lzZS5qcGdcIixcclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWU6IFwiTGFnbyBkaSBCcmFpZXNcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9sYWdvLmpwZ1wiLFxyXG4gIH0sXHJcbl07XHJcblxyXG5jb25zdCBvcHRpb25zID0ge1xyXG4gIGZvcm1TZWxlY3RvcjogXCIubW9kYWxfX2NvbnRhaW5lci1mb3JtXCIsXHJcbiAgaW5wdXRTZWxlY3RvcjogXCIubW9kYWxfX2NvbnRhaW5lci1pbnB1dFwiLFxyXG4gIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5tb2RhbF9fYnV0dG9uXCIsXHJcbiAgaW5hY3RpdmVCdXR0b25DbGFzczogXCJtb2RhbF9fYnV0dG9uX2Rpc2FibGVkXCIsXHJcbiAgaW5wdXRFcnJvckNsYXNzOiBcIm1vZGFsX19pbnB1dF9lcnJvclwiLFxyXG4gIGVycm9yQ2xhc3M6IFwibW9kYWxfX2Vycm9yX3Zpc2libGVcIixcclxufTtcclxuXHJcbmV4cG9ydCB7IGluaXRpYWxDYXJkcywgb3B0aW9ucyB9O1xyXG4iLCJpbXBvcnQgQ2FyZCBmcm9tIFwiLi4vY29tcG9uZW50cy9DYXJkLmpzXCI7XHJcbmltcG9ydCBGb3JtVmFsaWRhdG9yIGZyb20gXCIuLi9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanNcIjtcclxuaW1wb3J0IFNlY3Rpb24gZnJvbSBcIi4uL2NvbXBvbmVudHMvU2VjdGlvbi5qc1wiO1xyXG5pbXBvcnQgUG9wdXBXaXRoSW1hZ2UgZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanNcIjtcclxuaW1wb3J0IFBvcHVwV2l0aEZvcm0gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qc1wiO1xyXG5pbXBvcnQgVXNlckluZm8gZnJvbSBcIi4uL2NvbXBvbmVudHMvVXNlckluZm8uanNcIjtcclxuaW1wb3J0IFwiLi9pbmRleC5jc3NcIjtcclxuaW1wb3J0IHsgaW5pdGlhbENhcmRzLCBvcHRpb25zIH0gZnJvbSBcIi4uL3V0aWxzL2NvbnN0YW50cy5qc1wiO1xyXG5pbXBvcnQgQXBpIGZyb20gXCIuLi9jb21wb25lbnRzL0FwaS5qc1wiO1xyXG5pbXBvcnQgUG9wdXBXaXRoRGVsZXRlIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aERlbGV0ZS5qc1wiO1xyXG5cclxuLy9NYWluIFNlbGVjdG9yc1xyXG5jb25zdCBlZGl0Q2FyZE1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNjYXJkLW1vZGFsXCIpO1xyXG5jb25zdCBlZGl0UHJvZmlsZU1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNlZGl0LW1vZGFsXCIpO1xyXG5jb25zdCBwcm9maWxlSW1hZ2VNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS1pbWFnZS1tb2RhbFwiKTtcclxuY29uc3QgcHJvZmlsZUVkaXRGb3JtID0gZWRpdFByb2ZpbGVNb2RhbC5xdWVyeVNlbGVjdG9yKFxyXG4gIFwiLm1vZGFsX19jb250YWluZXItZm9ybVwiXHJcbik7XHJcbmNvbnN0IGNhcmRFZGl0Rm9ybSA9IGVkaXRDYXJkTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY29udGFpbmVyLWZvcm1cIik7XHJcbmNvbnN0IHByb2ZpbGVJbWFnZUVkaXRGb3JtID0gcHJvZmlsZUltYWdlTW9kYWwucXVlcnlTZWxlY3RvcihcclxuICBcIi5tb2RhbF9fY29udGFpbmVyLWZvcm1cIlxyXG4pO1xyXG5jb25zdCBwcmV2aWV3SW1hZ2VNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjaW1hZ2UtbW9kYWxcIik7XHJcbmNvbnN0IGRlbGV0ZUNhcmRNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjdHJhc2gtbW9kYWxcIik7XHJcbmNvbnN0IHByb2ZpbGVQaWMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2ltYWdlXCIpO1xyXG4vL0J1dHRvbnNcclxuY29uc3QgcHJvZmlsZUVkaXRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2VkaXQtYnV0dG9uXCIpO1xyXG5jb25zdCBwcm9maWxlSW1hZ2VFZGl0QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcclxuICBcIi5wcm9maWxlX19pbWFnZV9lZGl0LWJ1dHRvblwiXHJcbik7XHJcbmNvbnN0IGFkZE5ld0NhcmQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2FkZC1idXR0b25cIik7XHJcbi8vRm9ybSBEYXRhXHJcbmNvbnN0IHByb2ZpbGVOYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX190aXRsZVwiKTtcclxuY29uc3QgcHJvZmlsZURlc2NyaXB0aW9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19kZXNjcmlwdGlvblwiKTtcclxuY29uc3QgcHJvZmlsZU5hbWVJbnB1dCA9IGVkaXRQcm9maWxlTW9kYWwucXVlcnlTZWxlY3RvcihcIiNtb2RhbC1uYW1lXCIpO1xyXG5jb25zdCBwcm9maWxlRGVzY3JpcHRpb25JbnB1dCA9XHJcbiAgZWRpdFByb2ZpbGVNb2RhbC5xdWVyeVNlbGVjdG9yKFwiI21vZGFsLWRlc2NyaXB0aW9uXCIpO1xyXG5jb25zdCBwcm9maWxlUGljTW9kYWxJbnB1dCA9IHByb2ZpbGVJbWFnZU1vZGFsLnF1ZXJ5U2VsZWN0b3IoXHJcbiAgXCIubW9kYWxfX2NvbnRhaW5lci1pbnB1dFwiXHJcbik7XHJcblxyXG4vL0NhcmQgdGVtcGxhdGVcclxuY29uc3QgY2FyZExpc3RFbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZHNfX2xpc3RcIik7XHJcbi8vT3RoZXJcclxuY29uc3QgbG9hZGluZ0J1dHRvblRleHQgPSBcIlNhdmluZy4uLlwiO1xyXG5cclxuLy9cclxuLy9DbGFzcyBpbnN0YW50aWF0b3JzXHJcblxyXG4vL0Zvcm1WYWxpZGF0b3IgY2xhc3NcclxuY29uc3QgZWRpdEZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihvcHRpb25zLCBwcm9maWxlRWRpdEZvcm0pO1xyXG5jb25zdCBhZGRGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3Iob3B0aW9ucywgY2FyZEVkaXRGb3JtKTtcclxuY29uc3QgcHJvZmlsZVBpY0Zvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihcclxuICBvcHRpb25zLFxyXG4gIHByb2ZpbGVJbWFnZUVkaXRGb3JtXHJcbik7XHJcblxyXG5lZGl0Rm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XHJcbmFkZEZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xyXG5wcm9maWxlUGljRm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XHJcblxyXG4vL1BvcHVwV2l0aEltYWdlIENsYXNzXHJcbmNvbnN0IHBvcHVwUHJldmlld0ltYWdlID0gbmV3IFBvcHVwV2l0aEltYWdlKHByZXZpZXdJbWFnZU1vZGFsKTtcclxucG9wdXBQcmV2aWV3SW1hZ2Uuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbi8vUG9wdXBXaXRoRm9ybSBDbGFzc1xyXG5jb25zdCBwb3B1cFByb2ZpbGVGb3JtID0gbmV3IFBvcHVwV2l0aEZvcm0oXHJcbiAgZWRpdFByb2ZpbGVNb2RhbCxcclxuICBoYW5kbGVQcm9maWxlRm9ybVN1Ym1pdCxcclxuICBsb2FkaW5nQnV0dG9uVGV4dFxyXG4pO1xyXG5jb25zdCBwb3B1cENhcmRGb3JtID0gbmV3IFBvcHVwV2l0aEZvcm0oXHJcbiAgZWRpdENhcmRNb2RhbCxcclxuICBoYW5kbGVDYXJkRm9ybVN1Ym1pdCxcclxuICBsb2FkaW5nQnV0dG9uVGV4dFxyXG4pO1xyXG5jb25zdCBwb3B1cFByb2ZpbGVJbWFnZUZvcm0gPSBuZXcgUG9wdXBXaXRoRm9ybShcclxuICBwcm9maWxlSW1hZ2VNb2RhbCxcclxuICBoYW5kbGVQcm9maWxlSW1hZ2VGb3JtU3VibWl0LFxyXG4gIGxvYWRpbmdCdXR0b25UZXh0XHJcbik7XHJcbnBvcHVwUHJvZmlsZUZvcm0uc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxucG9wdXBDYXJkRm9ybS5zZXRFdmVudExpc3RlbmVycygpO1xyXG5wb3B1cFByb2ZpbGVJbWFnZUZvcm0uc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbi8vUG9wdXBXaXRoRGVsZXRlIENsYXNzXHJcbmNvbnN0IHBvcHVwV2l0aERlbGV0ZUNhcmQgPSBuZXcgUG9wdXBXaXRoRGVsZXRlKFxyXG4gIGRlbGV0ZUNhcmRNb2RhbCxcclxuICBsb2FkaW5nQnV0dG9uVGV4dFxyXG4pO1xyXG5wb3B1cFdpdGhEZWxldGVDYXJkLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG4vL1VzZXJJbmZvIENsYXNzXHJcbmNvbnN0IHVzZXJJbmZvID0gbmV3IFVzZXJJbmZvKHtcclxuICBuYW1lQ29udGFpbmVyOiBwcm9maWxlTmFtZSxcclxuICBkZXNjcmlwdGlvbkNvbnRhaW5lcjogcHJvZmlsZURlc2NyaXB0aW9uLFxyXG4gIHByb2ZpbGVQaWMsXHJcbn0pO1xyXG5cclxuLy9BcGkgQ2xhc3NcclxuY29uc3QgYXBpID0gbmV3IEFwaSh7XHJcbiAgYmFzZVVybDogXCJodHRwczovL2Fyb3VuZC1hcGkuZW4udHJpcGxldGVuLXNlcnZpY2VzLmNvbS92MVwiLFxyXG4gIGhlYWRlcnM6IHtcclxuICAgIGF1dGhvcml6YXRpb246IFwiMTc1NTU2M2EtZGYwMi00ZWNkLWFhOTEtNWM1OTU4YmVkYWRmXCIsXHJcbiAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcclxuICB9LFxyXG59KTtcclxuXHJcbi8vU2VjdGlvbiBDbGFzc1xyXG5jb25zdCBzZWN0aW9uID0gbmV3IFNlY3Rpb24oeyByZW5kZXJlcjogcmVuZGVyQ2FyZCB9LCBjYXJkTGlzdEVsKTtcclxuXHJcbmFwaVxyXG4gIC5nZXRJbml0aWFsQ2FyZHMoKVxyXG4gIC50aGVuKChjYXJkSXRlbXMpID0+IHtcclxuICAgIHNlY3Rpb24ucmVuZGVySXRlbXMoY2FyZEl0ZW1zKTtcclxuICB9KVxyXG4gIC5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmxvZyhlcnIpKTtcclxuXHJcbmFwaVxyXG4gIC5nZXRQcm9maWxlSW5mbygpXHJcbiAgLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgLy8gcHJvZmlsZVBpYy5zcmMgPSByZXMuYXZhdGFyO1xyXG4gICAgdXNlckluZm8uc2V0QXZhdGFyKHJlcy5hdmF0YXIpO1xyXG5cclxuICAgIHJldHVybiB1c2VySW5mby5zZXRVc2VySW5mbyh7XHJcbiAgICAgIG5hbWVJbnB1dDogcmVzLm5hbWUsXHJcbiAgICAgIGRlc2NyaXB0aW9uSW5wdXQ6IHJlcy5hYm91dCxcclxuICAgIH0pO1xyXG4gIH0pXHJcbiAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUubG9nKGVycikpO1xyXG5cclxuLy8gaW5pdGlhbENhcmRzLmZvckVhY2goKGNhcmQpID0+IHtcclxuLy8gICBhcGkuYWRkQ2FyZChjYXJkKTtcclxuLy8gfSk7XHJcblxyXG4vL1xyXG4vL0Z1bmN0aW9uc1xyXG5mdW5jdGlvbiBmaWxsUHJvZmlsZUlucHV0cygpIHtcclxuICBjb25zdCBpbnB1dHMgPSB1c2VySW5mby5nZXRVc2VySW5mbygpO1xyXG5cclxuICBwcm9maWxlTmFtZUlucHV0LnZhbHVlID0gaW5wdXRzLnByb2ZpbGVOYW1lO1xyXG4gIHByb2ZpbGVEZXNjcmlwdGlvbklucHV0LnZhbHVlID0gaW5wdXRzLnByb2ZpbGVEZXNjcmlwdGlvbjtcclxufVxyXG5cclxuZnVuY3Rpb24gaGFuZGxlUHJvZmlsZUZvcm1TdWJtaXQoZGF0YSkge1xyXG4gIHBvcHVwUHJvZmlsZUZvcm0uc2hvd0xvYWRpbmcoKTtcclxuXHJcbiAgYXBpXHJcbiAgICAudXBkYXRlUHJvZmlsZUluZm8oe1xyXG4gICAgICBuYW1lOiBkYXRhLnRpdGxlLFxyXG4gICAgICBhYm91dDogZGF0YS5kZXNjcmlwdGlvbixcclxuICAgIH0pXHJcbiAgICAudGhlbigoKSA9PiB7XHJcbiAgICAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKHtcclxuICAgICAgICBuYW1lSW5wdXQ6IGRhdGEudGl0bGUsXHJcbiAgICAgICAgZGVzY3JpcHRpb25JbnB1dDogZGF0YS5kZXNjcmlwdGlvbixcclxuICAgICAgfSk7XHJcbiAgICAgIHBvcHVwUHJvZmlsZUZvcm0uY2xvc2UoKTtcclxuICAgIH0pXHJcbiAgICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5sb2coZXJyKSlcclxuICAgIC5maW5hbGx5KCgpID0+IHtcclxuICAgICAgcG9wdXBQcm9maWxlRm9ybS5oaWRlTG9hZGluZygpO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGhhbmRsZUNhcmRGb3JtU3VibWl0KGRhdGEpIHtcclxuICBjb25zdCBuYW1lID0gZGF0YS50aXRsZTtcclxuICBjb25zdCBsaW5rID0gZGF0YS5kZXNjcmlwdGlvbjtcclxuICBwb3B1cENhcmRGb3JtLnNob3dMb2FkaW5nKCk7XHJcblxyXG4gIGFwaVxyXG4gICAgLmFkZENhcmQoeyBuYW1lOiBuYW1lLCBsaW5rOiBsaW5rIH0pXHJcbiAgICAudGhlbigoKSA9PiB7XHJcbiAgICAgIHJlbmRlckNhcmQoeyBuYW1lLCBsaW5rIH0pO1xyXG4gICAgICBwb3B1cENhcmRGb3JtLmNsb3NlKCk7XHJcbiAgICAgIGNhcmRFZGl0Rm9ybS5yZXNldCgpO1xyXG4gICAgICBhZGRGb3JtVmFsaWRhdG9yLnRvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUubG9nKGVycikpXHJcbiAgICAuZmluYWxseSgoKSA9PiB7XHJcbiAgICAgIHBvcHVwQ2FyZEZvcm0uaGlkZUxvYWRpbmcoKTtcclxuICAgIH0pO1xyXG59XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVQcm9maWxlSW1hZ2VGb3JtU3VibWl0KGRhdGEpIHtcclxuICBwb3B1cFByb2ZpbGVJbWFnZUZvcm0uc2hvd0xvYWRpbmcoKTtcclxuXHJcbiAgYXBpXHJcbiAgICAudXBkYXRlUHJvZmlsZVBpYyhkYXRhKVxyXG4gICAgLnRoZW4oKCkgPT4ge1xyXG4gICAgICB1c2VySW5mby5zZXRBdmF0YXIocHJvZmlsZVBpY01vZGFsSW5wdXQudmFsdWUpO1xyXG4gICAgICBwb3B1cFByb2ZpbGVJbWFnZUZvcm0uY2xvc2UoKTtcclxuICAgICAgcHJvZmlsZUltYWdlRWRpdEZvcm0ucmVzZXQoKTtcclxuICAgICAgYWRkRm9ybVZhbGlkYXRvci50b2dnbGVCdXR0b25TdGF0ZSgpO1xyXG4gICAgfSlcclxuICAgIC5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmxvZyhlcnIpKVxyXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xyXG4gICAgICBwb3B1cFByb2ZpbGVJbWFnZUZvcm0uaGlkZUxvYWRpbmcoKTtcclxuICAgIH0pO1xyXG59XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVJbWFnZUNsaWNrKGRhdGEpIHtcclxuICBwb3B1cFByZXZpZXdJbWFnZS5vcGVuKGRhdGEpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVEZWxldGVDbGljayhjYXJkRWwpIHtcclxuICBwb3B1cFdpdGhEZWxldGVDYXJkLm9wZW4oKTtcclxuICBwb3B1cFdpdGhEZWxldGVDYXJkLnNldFN1Ym1pdEFjdGlvbigoKSA9PiB7XHJcbiAgICBwb3B1cFdpdGhEZWxldGVDYXJkLnNob3dMb2FkaW5nKCk7XHJcbiAgICByZXR1cm4gYXBpXHJcbiAgICAgIC5kZWxldGVDYXJkKGNhcmRFbC5faWQpXHJcbiAgICAgIC50aGVuKCgpID0+IHtcclxuICAgICAgICBjYXJkRWwucmVtb3ZlKCk7XHJcbiAgICAgICAgcG9wdXBXaXRoRGVsZXRlQ2FyZC5jbG9zZSgpO1xyXG4gICAgICB9KVxyXG4gICAgICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5sb2coZXJyKSlcclxuICAgICAgLmZpbmFsbHkoKCkgPT4ge1xyXG4gICAgICAgIHBvcHVwV2l0aERlbGV0ZUNhcmQuaGlkZUxvYWRpbmcoKTtcclxuICAgICAgfSk7XHJcbiAgfSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGhhbmRsZUxpa2VCdXR0b24oY2FyZCkge1xyXG4gIGlmIChjYXJkLmlzTGlrZWQpIHtcclxuICAgIGFwaVxyXG4gICAgICAudG9nZ2xlQ2FyZERpc2xpa2UoY2FyZC5faWQpXHJcbiAgICAgIC50aGVuKChyZXMpID0+IGNhcmQuc2V0SXNMaWtlZChyZXMuX2lzTGlrZWQpKVxyXG4gICAgICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5sb2coZXJyKSk7XHJcbiAgfSBlbHNlIGlmICghY2FyZC5pc0xpa2VkKSB7XHJcbiAgICBhcGlcclxuICAgICAgLnRvZ2dsZUNhcmRMaWtlKGNhcmQuX2lkKVxyXG4gICAgICAudGhlbigocmVzKSA9PiBjYXJkLnNldElzTGlrZWQocmVzLl9pc0xpa2VkKSlcclxuICAgICAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUubG9nKGVycikpO1xyXG4gIH1cclxufVxyXG5cclxuLy8gZnVuY3Rpb24gaGFuZGxlTGlrZUNsaWNrKGNhcmRJZCkge1xyXG4vLyAgIHJldHVybiBhcGkudG9nZ2xlQ2FyZExpa2UoY2FyZElkKTtcclxuLy8gfVxyXG5cclxuLy8gZnVuY3Rpb24gaGFuZGxlRGlzbGlrZUNsaWNrKGNhcmRJZCkge1xyXG4vLyAgIHJldHVybiBhcGkudG9nZ2xlQ2FyZERpc2xpa2UoY2FyZElkKTtcclxuLy8gfVxyXG5cclxuZnVuY3Rpb24gcmVuZGVyQ2FyZChjYXJkRGF0YSkge1xyXG4gIGNvbnN0IGNhcmRFbGVtZW50ID0gbmV3IENhcmQoXHJcbiAgICBjYXJkRGF0YSxcclxuICAgIFwiLmNhcmQtdGVtcGxhdGVcIixcclxuICAgIGhhbmRsZUltYWdlQ2xpY2ssXHJcbiAgICBoYW5kbGVEZWxldGVDbGljayxcclxuICAgIGhhbmRsZUxpa2VCdXR0b25cclxuICApLnJldHVybkNhcmRFbGVtZW50KCk7XHJcbiAgc2VjdGlvbi5hZGRJdGVtKGNhcmRFbGVtZW50KTtcclxufVxyXG5cclxuLy9cclxuLy9FdmVudCBMaXN0ZW5lcnNcclxucHJvZmlsZUVkaXRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGZ1bmN0aW9uIChldmVudCkge1xyXG4gIGZpbGxQcm9maWxlSW5wdXRzKCk7XHJcbiAgcG9wdXBQcm9maWxlRm9ybS5vcGVuKCk7XHJcbn0pO1xyXG5cclxuYWRkTmV3Q2FyZC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGV2ZW50KSA9PiB7XHJcbiAgcG9wdXBDYXJkRm9ybS5vcGVuKCk7XHJcbn0pO1xyXG5cclxucHJvZmlsZUltYWdlRWRpdEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIHBvcHVwUHJvZmlsZUltYWdlRm9ybS5vcGVuKCk7XHJcbn0pO1xyXG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEltYWdlIGV4dGVuZHMgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcclxuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xyXG4gIH1cclxuXHJcbiAgb3BlbihkYXRhKSB7XHJcbiAgICBjb25zdCBwcmV2aWV3SW1hZ2UgPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9faW1hZ2VcIik7XHJcbiAgICBjb25zdCBwcmV2aWV3RGVzY3JpcHRpb24gPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAgICAgXCIubW9kYWxfX2ltYWdlLWRlc2NyaXB0aW9uXCJcclxuICAgICk7XHJcblxyXG4gICAgcHJldmlld0ltYWdlLnNyYyA9IGRhdGEubGluaztcclxuICAgIHByZXZpZXdJbWFnZS5hbHQgPSBkYXRhLm5hbWU7XHJcbiAgICBwcmV2aWV3RGVzY3JpcHRpb24udGV4dENvbnRlbnQgPSBkYXRhLm5hbWU7XHJcbiAgICBzdXBlci5vcGVuKCk7XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cFwiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoRGVsZXRlIGV4dGVuZHMgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IsIGxvYWRpbmdCdXR0b25UZXh0KSB7XHJcbiAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbiA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19idXR0b25cIik7XHJcbiAgICB0aGlzLl9idXR0b25UZXh0ID0gdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50O1xyXG4gICAgdGhpcy5fbG9hZGluZ0J1dHRvblRleHQgPSBsb2FkaW5nQnV0dG9uVGV4dDtcclxuICB9XHJcblxyXG4gIHNob3dMb2FkaW5nKCkge1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50ID0gdGhpcy5fbG9hZGluZ0J1dHRvblRleHQ7XHJcbiAgfVxyXG5cclxuICBoaWRlTG9hZGluZygpIHtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9IHRoaXMuX2J1dHRvblRleHQ7XHJcbiAgfVxyXG5cclxuICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG4gICAgdGhpcy5fbW9kYWxDb250YWluZXIuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZ0KSA9PiB7XHJcbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICB0aGlzLl9oYW5kbGVEZWxldGVGb3JtU3VibWl0KCk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIHNldFN1Ym1pdEFjdGlvbihhY3Rpb24pIHtcclxuICAgIHRoaXMuX2hhbmRsZURlbGV0ZUZvcm1TdWJtaXQgPSBhY3Rpb247XHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFVzZXJJbmZvIHtcclxuICBjb25zdHJ1Y3Rvcih7IG5hbWVDb250YWluZXIsIGRlc2NyaXB0aW9uQ29udGFpbmVyLCBwcm9maWxlUGljIH0pIHtcclxuICAgIHRoaXMuX25hbWVDb250YWluZXIgPSBuYW1lQ29udGFpbmVyO1xyXG4gICAgdGhpcy5fZGVzY3JpcHRpb25Db250YWluZXIgPSBkZXNjcmlwdGlvbkNvbnRhaW5lcjtcclxuICAgIHRoaXMuX3Byb2ZpbGVQaWMgPSBwcm9maWxlUGljO1xyXG4gIH1cclxuXHJcbiAgZ2V0VXNlckluZm8oKSB7XHJcbiAgICBjb25zdCBkYXRhID0ge307XHJcbiAgICBkYXRhW1wicHJvZmlsZU5hbWVcIl0gPSB0aGlzLl9uYW1lQ29udGFpbmVyLnRleHRDb250ZW50O1xyXG4gICAgZGF0YVtcInByb2ZpbGVEZXNjcmlwdGlvblwiXSA9IHRoaXMuX2Rlc2NyaXB0aW9uQ29udGFpbmVyLnRleHRDb250ZW50O1xyXG5cclxuICAgIHJldHVybiBkYXRhO1xyXG4gIH1cclxuXHJcbiAgc2V0QXZhdGFyKGltYWdlTGluaykge1xyXG4gICAgdGhpcy5fcHJvZmlsZVBpYy5zcmMgPSBpbWFnZUxpbms7XHJcbiAgfVxyXG5cclxuICBzZXRVc2VySW5mbyhkYXRhKSB7XHJcbiAgICB0aGlzLl9uYW1lQ29udGFpbmVyLnRleHRDb250ZW50ID0gZGF0YS5uYW1lSW5wdXQ7XHJcbiAgICB0aGlzLl9kZXNjcmlwdGlvbkNvbnRhaW5lci50ZXh0Q29udGVudCA9IGRhdGEuZGVzY3JpcHRpb25JbnB1dDtcclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQXBpIHtcclxuICBjb25zdHJ1Y3RvcihvcHRpb25zKSB7XHJcbiAgICB0aGlzLl9iYXNlVXJsID0gb3B0aW9ucy5iYXNlVXJsO1xyXG4gICAgdGhpcy5faGVhZGVycyA9IG9wdGlvbnMuaGVhZGVycztcclxuICB9XHJcblxyXG4gIF9wcm9jZXNzUmVzcG9uc2UgPSAocmVzKSA9PiB7XHJcbiAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xyXG4gIH07XHJcblxyXG4gIGdldEluaXRpYWxDYXJkcygpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkc2AsIHtcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pLnRoZW4odGhpcy5fcHJvY2Vzc1Jlc3BvbnNlKTtcclxuICB9XHJcblxyXG4gIGFkZENhcmQoYm9keSkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwge1xyXG4gICAgICBtZXRob2Q6IFwiUE9TVFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeShib2R5KSxcclxuICAgIH0pLnRoZW4odGhpcy5fcHJvY2Vzc1Jlc3BvbnNlKTtcclxuICB9XHJcblxyXG4gIGRlbGV0ZUNhcmQoY2FyZElkKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtjYXJkSWR9YCwge1xyXG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KS50aGVuKHRoaXMuX3Byb2Nlc3NSZXNwb25zZSk7XHJcbiAgfVxyXG5cclxuICB0b2dnbGVDYXJkTGlrZShjYXJkSWQpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2NhcmRJZH0vbGlrZXNgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJQVVRcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pLnRoZW4odGhpcy5fcHJvY2Vzc1Jlc3BvbnNlKTtcclxuICB9XHJcblxyXG4gIHRvZ2dsZUNhcmREaXNsaWtlKGNhcmRJZCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7Y2FyZElkfS9saWtlc2AsIHtcclxuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgfSkudGhlbih0aGlzLl9wcm9jZXNzUmVzcG9uc2UpO1xyXG4gIH1cclxuXHJcbiAgZ2V0UHJvZmlsZUluZm8oKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWVgLCB7XHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KS50aGVuKHRoaXMuX3Byb2Nlc3NSZXNwb25zZSk7XHJcbiAgfVxyXG5cclxuICB1cGRhdGVQcm9maWxlSW5mbyhib2R5KSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWVgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeShib2R5KSxcclxuICAgIH0pLnRoZW4odGhpcy5fcHJvY2Vzc1Jlc3BvbnNlKTtcclxuICB9XHJcblxyXG4gIHVwZGF0ZVByb2ZpbGVQaWMoYXZhdGFyKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWUvYXZhdGFyYCwge1xyXG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoYXZhdGFyKSxcclxuICAgIH0pLnRoZW4odGhpcy5fcHJvY2Vzc1Jlc3BvbnNlKTtcclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgU2VjdGlvbiB7XHJcbiAgY29uc3RydWN0b3IoeyByZW5kZXJlciB9LCBjb250YWluZXIpIHtcclxuICAgIHRoaXMuX3JlbmRlciA9IHJlbmRlcmVyO1xyXG4gICAgdGhpcy5fY29udGFpbmVyID0gY29udGFpbmVyO1xyXG4gIH1cclxuXHJcbiAgcmVuZGVySXRlbXMoaXRlbXMpIHtcclxuICAgIGl0ZW1zLmZvckVhY2goKGl0ZW0pID0+IHtcclxuICAgICAgcmV0dXJuIHRoaXMuX3JlbmRlcihpdGVtKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgYWRkSXRlbShlbGVtZW50KSB7XHJcbiAgICB0aGlzLl9jb250YWluZXIucHJlcGVuZChlbGVtZW50KTtcclxuICB9XHJcbn1cclxuIl0sIm5hbWVzIjpbIkNhcmQiLCJjb25zdHJ1Y3RvciIsImRhdGEiLCJjYXJkU2VsZWN0b3IiLCJoYW5kbGVJbWFnZUNsaWNrIiwiaGFuZGxlRGVsZXRlQ2xpY2siLCJoYW5kbGVMaWtlQnV0dG9uIiwidGhpcyIsIl9uYW1lIiwibmFtZSIsIl9saW5rIiwibGluayIsIl9pZCIsIl9pc0xpa2VkIiwiaXNMaWtlZCIsIl9jYXJkU2VsZWN0b3IiLCJfaGFuZGxlSW1hZ2VDbGljayIsIl9oYW5kbGVEZWxldGVDbGljayIsIl9oYW5kbGVMaWtlQnV0dG9uIiwiX3NldEV2ZW50TGlzdGVuZXJzIiwiX2NhcmRJbWFnZUVsZW1lbnQiLCJhZGRFdmVudExpc3RlbmVyIiwiX2xpa2VCdXR0b24iLCJfZGVsZXRlQnV0dG9uIiwicmVtb3ZlIiwiX2NhcmRFbGVtZW50Iiwic2V0SXNMaWtlZCIsIl9yZW5kZXJMaWtlcyIsImNsYXNzTGlzdCIsImFkZCIsInJldHVybkNhcmRFbGVtZW50IiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiY29udGVudCIsImNsb25lTm9kZSIsIl9jYXJkRGVzY3JpcHRpb24iLCJzcmMiLCJhbHQiLCJ0ZXh0Q29udGVudCIsIkZvcm1WYWxpZGF0b3IiLCJvcHRpb25zIiwiZm9ybUVsZW1lbnQiLCJfb3B0aW9ucyIsIl9pbnB1dFNlbGVjdG9yIiwiaW5wdXRTZWxlY3RvciIsIl9zdWJtaXRCdXR0b25TZWxlY3RvciIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiX2luYWN0aXZlQnV0dG9uQ2xhc3MiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiX2lucHV0RXJyb3JDbGFzcyIsImlucHV0RXJyb3JDbGFzcyIsIl9lcnJvckNsYXNzIiwiZXJyb3JDbGFzcyIsIl9mb3JtRWxlbWVudCIsIl9zaG93SW5wdXRFcnJvciIsImlucHV0RWwiLCJlcnJvck1lc3NhZ2VFbCIsImlkIiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJfaGlkZUlucHV0RXJyb3IiLCJfY2hlY2tJbnB1dFZhbGlkaXR5IiwidmFsaWRpdHkiLCJ2YWxpZCIsIl9jaGVja0Zvcm1WYWxpZGl0eSIsIkFycmF5IiwiZnJvbSIsIl9pbnB1dEVscyIsImV2ZXJ5IiwiaW5wdXQiLCJ0b2dnbGVCdXR0b25TdGF0ZSIsIl9zdWJtaXRCdXR0b24iLCJkaXNhYmxlZCIsImVuYWJsZVZhbGlkYXRpb24iLCJxdWVyeVNlbGVjdG9yQWxsIiwiZXZ0IiwicHJldmVudERlZmF1bHQiLCJmb3JFYWNoIiwiUG9wdXAiLCJwb3B1cFNlbGVjdG9yIiwiX3BvcHVwRWxlbWVudCIsIl9jbG9zZUJ1dHRvbiIsIl9tb2RhbENvbnRhaW5lciIsIl9ib3VuZEhhbmRsZUVzY2FwZUNsb3NlIiwiX2hhbmRsZUVzY2FwZUNsb3NlIiwiYmluZCIsIm9wZW4iLCJjbG9zZSIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJrZXkiLCJzZXRFdmVudExpc3RlbmVycyIsImV2ZW50Iiwic3RvcFByb3BhZ2F0aW9uIiwiUG9wdXBXaXRoRm9ybSIsImhhbmRsZUZvcm1TdWJtaXQiLCJsb2FkaW5nQnV0dG9uVGV4dCIsInN1cGVyIiwiX2hhbmRsZUZvcm1TdWJtaXQiLCJfYnV0dG9uVGV4dCIsIl9sb2FkaW5nQnV0dG9uVGV4dCIsIl9wb3B1cEZvcm0iLCJfaW5wdXRMaXN0Iiwic2hvd0xvYWRpbmciLCJoaWRlTG9hZGluZyIsIl9nZXRJbnB1dFZhbHVlcyIsInZhbHVlIiwiZm9ybURhdGEiLCJmb3JtU2VsZWN0b3IiLCJlZGl0Q2FyZE1vZGFsIiwiZWRpdFByb2ZpbGVNb2RhbCIsInByb2ZpbGVJbWFnZU1vZGFsIiwicHJvZmlsZUVkaXRGb3JtIiwiY2FyZEVkaXRGb3JtIiwicHJvZmlsZUltYWdlRWRpdEZvcm0iLCJwcmV2aWV3SW1hZ2VNb2RhbCIsImRlbGV0ZUNhcmRNb2RhbCIsInByb2ZpbGVQaWMiLCJwcm9maWxlRWRpdEJ1dHRvbiIsInByb2ZpbGVJbWFnZUVkaXRCdXR0b24iLCJhZGROZXdDYXJkIiwicHJvZmlsZU5hbWUiLCJwcm9maWxlRGVzY3JpcHRpb24iLCJwcm9maWxlTmFtZUlucHV0IiwicHJvZmlsZURlc2NyaXB0aW9uSW5wdXQiLCJwcm9maWxlUGljTW9kYWxJbnB1dCIsImNhcmRMaXN0RWwiLCJlZGl0Rm9ybVZhbGlkYXRvciIsImFkZEZvcm1WYWxpZGF0b3IiLCJwcm9maWxlUGljRm9ybVZhbGlkYXRvciIsInBvcHVwUHJldmlld0ltYWdlIiwicHJldmlld0ltYWdlIiwicHJldmlld0Rlc2NyaXB0aW9uIiwicG9wdXBQcm9maWxlRm9ybSIsImFwaSIsInVwZGF0ZVByb2ZpbGVJbmZvIiwidGl0bGUiLCJhYm91dCIsImRlc2NyaXB0aW9uIiwidGhlbiIsInVzZXJJbmZvIiwic2V0VXNlckluZm8iLCJuYW1lSW5wdXQiLCJkZXNjcmlwdGlvbklucHV0IiwiY2F0Y2giLCJlcnIiLCJjb25zb2xlIiwibG9nIiwiZmluYWxseSIsInBvcHVwQ2FyZEZvcm0iLCJhZGRDYXJkIiwicmVuZGVyQ2FyZCIsInJlc2V0IiwicG9wdXBQcm9maWxlSW1hZ2VGb3JtIiwidXBkYXRlUHJvZmlsZVBpYyIsInNldEF2YXRhciIsInBvcHVwV2l0aERlbGV0ZUNhcmQiLCJfaGFuZGxlRGVsZXRlRm9ybVN1Ym1pdCIsInNldFN1Ym1pdEFjdGlvbiIsImFjdGlvbiIsIl9yZWYiLCJuYW1lQ29udGFpbmVyIiwiZGVzY3JpcHRpb25Db250YWluZXIiLCJfbmFtZUNvbnRhaW5lciIsIl9kZXNjcmlwdGlvbkNvbnRhaW5lciIsIl9wcm9maWxlUGljIiwiZ2V0VXNlckluZm8iLCJpbWFnZUxpbmsiLCJfYmFzZVVybCIsImJhc2VVcmwiLCJfaGVhZGVycyIsImhlYWRlcnMiLCJfcHJvY2Vzc1Jlc3BvbnNlIiwicmVzIiwib2siLCJqc29uIiwiUHJvbWlzZSIsInJlamVjdCIsInN0YXR1cyIsImdldEluaXRpYWxDYXJkcyIsImZldGNoIiwiYm9keSIsIm1ldGhvZCIsIkpTT04iLCJzdHJpbmdpZnkiLCJkZWxldGVDYXJkIiwiY2FyZElkIiwidG9nZ2xlQ2FyZExpa2UiLCJ0b2dnbGVDYXJkRGlzbGlrZSIsImdldFByb2ZpbGVJbmZvIiwiYXZhdGFyIiwiYXV0aG9yaXphdGlvbiIsInNlY3Rpb24iLCJjb250YWluZXIiLCJyZW5kZXJlciIsIl9yZW5kZXIiLCJfY29udGFpbmVyIiwicmVuZGVySXRlbXMiLCJpdGVtcyIsIml0ZW0iLCJhZGRJdGVtIiwiZWxlbWVudCIsInByZXBlbmQiLCJjYXJkRWwiLCJjYXJkIiwiY2FyZERhdGEiLCJjYXJkRWxlbWVudCIsImNhcmRJdGVtcyIsImlucHV0cyIsImZpbGxQcm9maWxlSW5wdXRzIl0sInNvdXJjZVJvb3QiOiIifQ==